<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <!-- crucial for mobile scaling -->
  <title>üìö Study Materials</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #f4f4f4;
      color: #222;
      margin: 0;
      padding: 16px;
      box-sizing: border-box;
    }

    h1, h2 {
      text-align: center;
      margin: 10px 0;
      line-height: 1.4;
    }

    select, input, button {
      display: block;
      width: 100%;
      max-width: 500px;
      margin: 10px auto;
      padding: 14px;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid #ccc;
      background-color: #fff;
      box-sizing: border-box;
      transition: all 0.3s ease;
    }

    select:focus, input:focus {
      border-color: #007BFF;
      outline: none;
      box-shadow: 0 0 6px rgba(0,123,255,0.3);
    }

    button {
      background-color: #007BFF;
      color: white;
      border: none;
      font-weight: 600;
      cursor: pointer;
    }

    button:disabled {
      background-color: #6c757d;
      cursor: not-allowed;
    }

    button:hover:enabled {
      background-color: #0056b3;
      transform: scale(1.02);
    }

    .material {
      background: white;
      padding: 15px;
      margin: 12px auto;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      max-width: 600px;
      word-wrap: break-word;
    }

    .material a {
      text-decoration: none;
      color: #007BFF;
      font-weight: 600;
    }

    .material a:hover {
      text-decoration: underline;
    }

    #results h2 {
      margin-top: 25px;
      font-size: 1.2rem;
    }

    .ai-tab {
      text-align: center;
      margin: 30px 0 15px 0;
    }

    .ai-tab a {
      padding: 12px 24px;
      background-color: #28a745;
      color: white;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      display: inline-block;
      transition: all 0.3s ease;
    }

    .ai-tab a:hover {
      background-color: #1e7e34;
      transform: scale(1.05);
    }

    /* make results readable and smooth on small screens */
    #results {
      padding-bottom: 40px;
    }

    /* mobile spacing */
    @media (max-width: 480px) {
      body {
        padding: 12px;
      }
      select, input, button {
        font-size: 0.95rem;
        padding: 12px;
      }
      h1 {
        font-size: 1.3rem;
      }
      .ai-tab a {
        width: 90%;
      }
    }
  </style>
</head>
<body>

  <h1>üìö Study Materials</h1>
  <h2>Select Course and Level</h2>

  <select id="course">
    <option value="">-- Select Course --</option>
    <!-- your options here -->
    <option value="Accountancy">Accountancy</option>
    <option value="Accounting">Accounting</option>
    <option value="Agriculture">Agriculture</option>
    <option value="Arabic Studies">Arabic Studies</option>
    <option value="Banking and Finance">Banking and Finance</option>
    <option value="Biochemistry">Biochemistry</option>
    <option value="Botany">Botany</option>
    <option value="Business Administration">Business Administration</option>
    <option value="Computer Science">Computer Science</option>
    <option value="Economics">Economics</option>
    <option value="Mathematics">Mathematics</option>
    <option value="Political Science">Political Science</option>
    <option value="Sociology">Sociology</option>
    <!-- ...continue as needed -->
  </select>

  <select id="level">
    <option value="">-- Select Level --</option>
    <option value="100">100 Level</option>
    <option value="200">200 Level</option>
    <option value="300">300 Level</option>
    <option value="400">400 Level</option>
  </select>

  <input type="text" id="topic" placeholder="Enter topic" />
  <button id="searchBtn">üîç Search Materials</button>

  <div id="results"></div>

  <div class="ai-tab">
    <a href="/teach-me-ai">ü§ñ Teach Me with AI</a>
  </div>

  <script>
    const btn = document.getElementById('searchBtn');

    btn.addEventListener('click', () => {
      const course = document.getElementById('course').value;
      const level = document.getElementById('level').value;
      const topic = document.getElementById('topic').value.trim();

      if (!course || !topic || !level) {
        alert("Please select course, level, and enter topic.");
        return;
      }

      btn.textContent = "üîç Searching...";
      btn.disabled = true;

      const url = `/ai/materials?topic=${encodeURIComponent(topic)}&level=${encodeURIComponent(level)}&department=${encodeURIComponent(course)}`;

      fetch(url)
        .then(res => res.json())
        .then(data => {
          btn.textContent = "üîç Search Materials";
          btn.disabled = false;

          const container = document.getElementById('results');
          container.innerHTML = '';

          if (data.books?.length > 0) {
            container.innerHTML += `<h2>üìñ Books</h2>`;
            data.books.forEach(book => {
              container.innerHTML += `
                <div class="material">
                  <strong>${book.title}</strong><br/>
                  <em>${book.author}</em><br/>
                  <a href="${book.link}" target="_blank">Read</a>
                </div>
              `;
            });
          }

          if (data.videos?.length > 0) {
            container.innerHTML += `<h2>üé• Videos</h2>`;
            data.videos.forEach(video => {
              container.innerHTML += `
                <div class="material">
                  <strong>${video.title}</strong><br/>
                  <a href="${video.link}" target="_blank">Watch</a>
                </div>
              `;
            });
          }

          if ((!data.books || data.books.length === 0) &&
              (!data.videos || data.videos.length === 0)) {
            container.innerHTML = "<p>No materials found for this course.</p>";
          }
        })
        .catch(err => {
          document.getElementById('results').innerHTML = "‚ùå Error loading materials.";
          console.error(err);
          btn.textContent = "üîç Search Materials";
          btn.disabled = false;
        });
    });
  </script>

</body>
</html>
